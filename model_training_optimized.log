2025-09-30 08:17:13,521 - INFO - ================================================================================
2025-09-30 08:17:13,522 - INFO - OPTIMIZED MODEL TRAINING
2025-09-30 08:17:13,522 - INFO - Improvements: Feature selection, Walk-forward validation, Model comparison
2025-09-30 08:17:13,522 - INFO - ================================================================================
2025-09-30 08:17:13,522 - INFO - 
================================================================================
2025-09-30 08:17:13,522 - INFO - Training optimized models for league 4986 (Rugby Championship)
2025-09-30 08:17:13,522 - INFO - ================================================================================
2025-09-30 08:17:13,628 - INFO - Total games: 140
2025-09-30 08:17:13,628 - INFO - Total features before selection: 57
2025-09-30 08:17:13,631 - INFO - Selecting top 50 features from 57 total
2025-09-30 08:17:17,869 - INFO - Top 10 features: ['elo_momentum_interaction', 'elo_form_interaction', 'goal_diff_form_diff', 'elo_home_pre', 'form_momentum_interaction', 'away_wr_away', 'away_momentum_trend', 'away_form', 'away_form_10', 'home_goal_diff_form']
2025-09-30 08:17:17,870 - INFO - Features after selection: 50
2025-09-30 08:17:17,870 - INFO - Created 5 time-based splits
2025-09-30 08:17:17,870 - INFO - 
Split 1/5: Train=70, Test=14
2025-09-30 08:17:20,845 - INFO -   Simple - Acc: 0.500, Home MAE: 10.61, Away MAE: 7.85
2025-09-30 08:17:20,845 - INFO -   Stack  - Acc: 0.714, Home MAE: 9.86, Away MAE: 7.62
2025-09-30 08:17:20,845 - INFO - 
Split 2/5: Train=84, Test=14
2025-09-30 08:17:24,106 - INFO -   Simple - Acc: 0.500, Home MAE: 12.19, Away MAE: 10.04
2025-09-30 08:17:24,106 - INFO -   Stack  - Acc: 0.500, Home MAE: 11.17, Away MAE: 8.70
2025-09-30 08:17:24,106 - INFO - 
Split 3/5: Train=98, Test=14
2025-09-30 08:17:27,743 - INFO -   Simple - Acc: 0.429, Home MAE: 14.20, Away MAE: 10.61
2025-09-30 08:17:27,743 - INFO -   Stack  - Acc: 0.571, Home MAE: 10.44, Away MAE: 8.57
2025-09-30 08:17:27,743 - INFO - 
Split 4/5: Train=112, Test=14
2025-09-30 08:17:31,659 - INFO -   Simple - Acc: 0.643, Home MAE: 11.28, Away MAE: 10.57
2025-09-30 08:17:31,660 - INFO -   Stack  - Acc: 0.571, Home MAE: 11.08, Away MAE: 7.70
2025-09-30 08:17:31,660 - INFO - 
Split 5/5: Train=126, Test=14
2025-09-30 08:17:35,766 - INFO -   Simple - Acc: 0.643, Home MAE: 10.35, Away MAE: 9.76
2025-09-30 08:17:35,766 - INFO -   Stack  - Acc: 0.643, Home MAE: 9.48, Away MAE: 8.25
2025-09-30 08:17:35,766 - INFO - 
================================================================================
2025-09-30 08:17:35,767 - INFO - COMPARISON RESULTS - Rugby Championship
2025-09-30 08:17:35,767 - INFO - ================================================================================
2025-09-30 08:17:35,767 - INFO - Simple Model:
2025-09-30 08:17:35,767 - INFO -   Accuracy: 0.543 ± 0.086
2025-09-30 08:17:35,767 - INFO -   Overall MAE: 10.75
2025-09-30 08:17:35,767 - INFO - 
Stacking Model:
2025-09-30 08:17:35,767 - INFO -   Accuracy: 0.600 ± 0.073
2025-09-30 08:17:35,767 - INFO -   Overall MAE: 9.29
2025-09-30 08:17:35,808 - INFO - ================================================================================
2025-09-30 08:17:39,573 - INFO - 
================================================================================
2025-09-30 08:17:39,574 - INFO - Training optimized models for league 4446 (United Rugby Championship)
2025-09-30 08:17:39,574 - INFO - ================================================================================
2025-09-30 08:17:39,644 - INFO - Total games: 254
2025-09-30 08:17:39,645 - INFO - Total features before selection: 57
2025-09-30 08:17:39,646 - INFO - Selecting top 50 features from 57 total
2025-09-30 08:17:40,427 - INFO - Top 10 features: ['away_wr_away', 'home_wr_home', 'strength_ratio_advanced', 'elo_away_pre', 'momentum_diff', 'elo_diff_squared', 'home_goal_diff_form', 'home_momentum', 'elo_diff', 'rest_diff']
2025-09-30 08:17:40,428 - INFO - Features after selection: 50
2025-09-30 08:17:40,428 - INFO - Created 5 time-based splits
2025-09-30 08:17:40,429 - INFO - 
Split 1/5: Train=127, Test=25
2025-09-30 08:17:44,806 - INFO -   Simple - Acc: 0.720, Home MAE: 12.23, Away MAE: 8.68
2025-09-30 08:17:44,806 - INFO -   Stack  - Acc: 0.640, Home MAE: 9.80, Away MAE: 8.09
2025-09-30 08:17:44,806 - INFO - 
Split 2/5: Train=152, Test=25
2025-09-30 08:17:49,602 - INFO -   Simple - Acc: 0.520, Home MAE: 13.42, Away MAE: 8.80
2025-09-30 08:17:49,603 - INFO -   Stack  - Acc: 0.640, Home MAE: 12.20, Away MAE: 7.33
2025-09-30 08:17:49,603 - INFO - 
Split 3/5: Train=177, Test=25
2025-09-30 08:17:55,056 - INFO -   Simple - Acc: 0.720, Home MAE: 9.39, Away MAE: 7.90
2025-09-30 08:17:55,056 - INFO -   Stack  - Acc: 0.760, Home MAE: 8.36, Away MAE: 6.81
2025-09-30 08:17:55,057 - INFO - 
Split 4/5: Train=202, Test=25
2025-09-30 08:18:00,865 - INFO -   Simple - Acc: 0.680, Home MAE: 13.32, Away MAE: 9.02
2025-09-30 08:18:00,865 - INFO -   Stack  - Acc: 0.640, Home MAE: 11.83, Away MAE: 8.65
2025-09-30 08:18:00,865 - INFO - 
Split 5/5: Train=227, Test=25
2025-09-30 08:18:07,125 - INFO -   Simple - Acc: 0.560, Home MAE: 9.50, Away MAE: 7.24
2025-09-30 08:18:07,125 - INFO -   Stack  - Acc: 0.640, Home MAE: 9.40, Away MAE: 6.41
2025-09-30 08:18:07,125 - INFO - 
================================================================================
2025-09-30 08:18:07,125 - INFO - COMPARISON RESULTS - United Rugby Championship
2025-09-30 08:18:07,125 - INFO - ================================================================================
2025-09-30 08:18:07,125 - INFO - Simple Model:
2025-09-30 08:18:07,125 - INFO -   Accuracy: 0.640 ± 0.084
2025-09-30 08:18:07,125 - INFO -   Overall MAE: 9.95
2025-09-30 08:18:07,126 - INFO - 
Stacking Model:
2025-09-30 08:18:07,126 - INFO -   Accuracy: 0.664 ± 0.048
2025-09-30 08:18:07,126 - INFO -   Overall MAE: 8.89
2025-09-30 08:18:07,127 - INFO - ================================================================================
2025-09-30 08:18:13,016 - INFO - 
================================================================================
2025-09-30 08:18:13,016 - INFO - Training optimized models for league 5069 (Currie Cup)
2025-09-30 08:18:13,016 - INFO - ================================================================================
2025-09-30 08:18:13,094 - INFO - Total games: 229
2025-09-30 08:18:13,094 - INFO - Total features before selection: 57
2025-09-30 08:18:13,096 - INFO - Selecting top 50 features from 57 total
2025-09-30 08:18:13,841 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'away_rest_impact', 'elo_diff_squared', 'momentum_squared', 'home_strength_composite', 'rest_impact_diff', 'away_form', 'form_diff_squared', 'goal_diff_form_diff']
2025-09-30 08:18:13,841 - INFO - Features after selection: 50
2025-09-30 08:18:13,841 - INFO - Created 5 time-based splits
2025-09-30 08:18:13,841 - INFO - 
Split 1/5: Train=114, Test=23
2025-09-30 08:18:17,712 - INFO -   Simple - Acc: 0.478, Home MAE: 11.23, Away MAE: 13.99
2025-09-30 08:18:17,712 - INFO -   Stack  - Acc: 0.565, Home MAE: 10.51, Away MAE: 13.87
2025-09-30 08:18:17,712 - INFO - 
Split 2/5: Train=137, Test=23
2025-09-30 08:18:22,156 - INFO -   Simple - Acc: 0.609, Home MAE: 10.47, Away MAE: 8.42
2025-09-30 08:18:22,156 - INFO -   Stack  - Acc: 0.565, Home MAE: 8.13, Away MAE: 7.12
2025-09-30 08:18:22,156 - INFO - 
Split 3/5: Train=160, Test=23
2025-09-30 08:18:27,056 - INFO -   Simple - Acc: 0.609, Home MAE: 12.33, Away MAE: 8.06
2025-09-30 08:18:27,056 - INFO -   Stack  - Acc: 0.522, Home MAE: 10.00, Away MAE: 10.46
2025-09-30 08:18:27,056 - INFO - 
Split 4/5: Train=183, Test=23
2025-09-30 08:18:32,599 - INFO -   Simple - Acc: 0.435, Home MAE: 13.02, Away MAE: 14.63
2025-09-30 08:18:32,599 - INFO -   Stack  - Acc: 0.478, Home MAE: 10.49, Away MAE: 13.31
2025-09-30 08:18:32,599 - INFO - 
Split 5/5: Train=206, Test=23
2025-09-30 08:18:38,515 - INFO -   Simple - Acc: 0.652, Home MAE: 12.74, Away MAE: 13.10
2025-09-30 08:18:38,515 - INFO -   Stack  - Acc: 0.783, Home MAE: 14.71, Away MAE: 12.30
2025-09-30 08:18:38,515 - INFO - 
================================================================================
2025-09-30 08:18:38,515 - INFO - COMPARISON RESULTS - Currie Cup
2025-09-30 08:18:38,516 - INFO - ================================================================================
2025-09-30 08:18:38,516 - INFO - Simple Model:
2025-09-30 08:18:38,516 - INFO -   Accuracy: 0.557 ± 0.084
2025-09-30 08:18:38,516 - INFO -   Overall MAE: 11.80
2025-09-30 08:18:38,516 - INFO - 
Stacking Model:
2025-09-30 08:18:38,516 - INFO -   Accuracy: 0.583 ± 0.105
2025-09-30 08:18:38,516 - INFO -   Overall MAE: 11.09
2025-09-30 08:18:38,517 - INFO - ================================================================================
2025-09-30 08:18:43,993 - INFO - 
================================================================================
2025-09-30 08:18:43,994 - INFO - Training optimized models for league 4574 (Rugby World Cup)
2025-09-30 08:18:43,994 - INFO - ================================================================================
2025-09-30 08:18:44,058 - INFO - Total games: 151
2025-09-30 08:18:44,058 - INFO - Total features before selection: 57
2025-09-30 08:18:44,059 - INFO - Selecting top 50 features from 57 total
2025-09-30 08:18:44,744 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'away_rest_days', 'elo_diff_squared', 'momentum_squared', 'elo_diff', 'form_diff', 'elo_away_pre', 'elo_home_pre', 'home_goal_diff_form']
2025-09-30 08:18:44,744 - INFO - Features after selection: 50
2025-09-30 08:18:44,745 - INFO - Created 5 time-based splits
2025-09-30 08:18:44,745 - INFO - 
Split 1/5: Train=75, Test=15
2025-09-30 08:18:44,856 - ERROR - Failed to train models for league 4574: y_true contains only one label (1). Please provide the true labels explicitly through the labels argument.
Traceback (most recent call last):
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 425, in main
    model_package = train_league_optimized(league_id, db_path)
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 270, in train_league_optimized
    clf_results = train_and_evaluate(X_train, y_clf_train, X_test, y_clf_test,
                                    model_type, 'classification')
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 181, in train_and_evaluate
    logloss = log_loss(y_test, y_proba)
  File "C:\Users\Dylan\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Dylan\AppData\Roaming\Python\Python313\site-packages\sklearn\metrics\_classification.py", line 2925, in log_loss
    raise ValueError(
    ...<3 lines>...
    )
ValueError: y_true contains only one label (1). Please provide the true labels explicitly through the labels argument.
2025-09-30 08:18:44,957 - INFO - Saved optimized model for league 4986 to artifacts_optimized\league_4986_model_optimized.pkl
2025-09-30 08:18:44,976 - INFO - Saved optimized model for league 4446 to artifacts_optimized\league_4446_model_optimized.pkl
2025-09-30 08:18:44,996 - INFO - Saved optimized model for league 5069 to artifacts_optimized\league_5069_model_optimized.pkl
2025-09-30 08:18:44,997 - INFO - Saved optimized model registry to artifacts_optimized\model_registry_optimized.json
2025-09-30 08:18:44,997 - INFO - 
================================================================================
2025-09-30 08:18:44,997 - INFO - Successfully trained optimized models for 3 leagues
2025-09-30 08:18:44,997 - INFO - ================================================================================
2025-09-30 08:18:44,997 - INFO - Rugby Championship: STACKING (Acc: 60.0%, MAE: 9.29)
2025-09-30 08:18:44,997 - INFO - United Rugby Championship: STACKING (Acc: 66.4%, MAE: 8.89)
2025-09-30 08:18:44,997 - INFO - Currie Cup: STACKING (Acc: 58.3%, MAE: 11.09)
2025-09-30 08:18:44,997 - INFO - 
Optimized model training completed successfully
2025-09-30 13:59:40,151 - INFO - ================================================================================
2025-09-30 13:59:40,151 - INFO - OPTIMIZED MODEL TRAINING
2025-09-30 13:59:40,151 - INFO - Improvements: Feature selection, Walk-forward validation, Model comparison
2025-09-30 13:59:40,151 - INFO - ================================================================================
2025-09-30 13:59:40,151 - INFO - 
================================================================================
2025-09-30 13:59:40,152 - INFO - Training optimized models for league 4986 (Rugby Championship)
2025-09-30 13:59:40,152 - INFO - ================================================================================
2025-09-30 13:59:40,219 - INFO - Total games: 140
2025-09-30 13:59:40,219 - INFO - Total features before selection: 57
2025-09-30 13:59:40,221 - INFO - Selecting top 50 features from 57 total
2025-09-30 13:59:44,102 - INFO - Top 10 features: ['elo_momentum_interaction', 'elo_form_interaction', 'goal_diff_form_diff', 'elo_home_pre', 'form_momentum_interaction', 'away_wr_away', 'away_momentum_trend', 'away_form', 'away_form_10', 'home_goal_diff_form']
2025-09-30 13:59:44,103 - INFO - Features after selection: 50
2025-09-30 13:59:44,103 - INFO - Created 5 time-based splits
2025-09-30 13:59:44,103 - INFO - 
Split 1/5: Train=70, Test=14
2025-09-30 13:59:46,988 - INFO -   Simple - Acc: 0.500, Home MAE: 10.61, Away MAE: 7.85
2025-09-30 13:59:46,988 - INFO -   Stack  - Acc: 0.714, Home MAE: 9.86, Away MAE: 7.62
2025-09-30 13:59:46,988 - INFO - 
Split 2/5: Train=84, Test=14
2025-09-30 13:59:50,047 - INFO -   Simple - Acc: 0.500, Home MAE: 12.19, Away MAE: 10.04
2025-09-30 13:59:50,047 - INFO -   Stack  - Acc: 0.500, Home MAE: 11.17, Away MAE: 8.70
2025-09-30 13:59:50,047 - INFO - 
Split 3/5: Train=98, Test=14
2025-09-30 13:59:53,415 - INFO -   Simple - Acc: 0.429, Home MAE: 14.20, Away MAE: 10.61
2025-09-30 13:59:53,415 - INFO -   Stack  - Acc: 0.571, Home MAE: 10.44, Away MAE: 8.57
2025-09-30 13:59:53,416 - INFO - 
Split 4/5: Train=112, Test=14
2025-09-30 13:59:57,099 - INFO -   Simple - Acc: 0.643, Home MAE: 11.28, Away MAE: 10.57
2025-09-30 13:59:57,099 - INFO -   Stack  - Acc: 0.571, Home MAE: 11.08, Away MAE: 7.70
2025-09-30 13:59:57,099 - INFO - 
Split 5/5: Train=126, Test=14
2025-09-30 14:00:01,087 - INFO -   Simple - Acc: 0.643, Home MAE: 10.35, Away MAE: 9.76
2025-09-30 14:00:01,087 - INFO -   Stack  - Acc: 0.643, Home MAE: 9.48, Away MAE: 8.25
2025-09-30 14:00:01,087 - INFO - 
================================================================================
2025-09-30 14:00:01,087 - INFO - COMPARISON RESULTS - Rugby Championship
2025-09-30 14:00:01,087 - INFO - ================================================================================
2025-09-30 14:00:01,087 - INFO - Simple Model:
2025-09-30 14:00:01,087 - INFO -   Accuracy: 0.543 ± 0.086
2025-09-30 14:00:01,088 - INFO -   Overall MAE: 10.75
2025-09-30 14:00:01,088 - INFO - 
Stacking Model:
2025-09-30 14:00:01,088 - INFO -   Accuracy: 0.600 ± 0.073
2025-09-30 14:00:01,088 - INFO -   Overall MAE: 9.29
2025-09-30 14:00:01,090 - INFO - ================================================================================
2025-09-30 14:00:04,686 - INFO - 
================================================================================
2025-09-30 14:00:04,686 - INFO - Training optimized models for league 4446 (United Rugby Championship)
2025-09-30 14:00:04,686 - INFO - ================================================================================
2025-09-30 14:00:04,747 - INFO - Total games: 260
2025-09-30 14:00:04,748 - INFO - Total features before selection: 57
2025-09-30 14:00:04,749 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:00:05,513 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'strength_ratio_advanced', 'elo_diff_squared', 'home_goal_diff_form', 'elo_away_pre', 'momentum_diff', 'goal_diff_form_diff', 'elo_diff', 'rest_diff']
2025-09-30 14:00:05,514 - INFO - Features after selection: 50
2025-09-30 14:00:05,514 - INFO - Created 5 time-based splits
2025-09-30 14:00:05,514 - INFO - 
Split 1/5: Train=130, Test=26
2025-09-30 14:00:09,602 - INFO -   Simple - Acc: 0.654, Home MAE: 10.81, Away MAE: 7.47
2025-09-30 14:00:09,602 - INFO -   Stack  - Acc: 0.692, Home MAE: 8.71, Away MAE: 6.74
2025-09-30 14:00:09,602 - INFO - 
Split 2/5: Train=156, Test=26
2025-09-30 14:00:14,223 - INFO -   Simple - Acc: 0.577, Home MAE: 11.71, Away MAE: 9.19
2025-09-30 14:00:14,223 - INFO -   Stack  - Acc: 0.577, Home MAE: 11.87, Away MAE: 7.94
2025-09-30 14:00:14,224 - INFO - 
Split 3/5: Train=182, Test=26
2025-09-30 14:00:19,412 - INFO -   Simple - Acc: 0.654, Home MAE: 10.06, Away MAE: 6.71
2025-09-30 14:00:19,412 - INFO -   Stack  - Acc: 0.731, Home MAE: 9.03, Away MAE: 7.01
2025-09-30 14:00:19,412 - INFO - 
Split 4/5: Train=208, Test=26
2025-09-30 14:00:25,258 - INFO -   Simple - Acc: 0.654, Home MAE: 13.26, Away MAE: 9.53
2025-09-30 14:00:25,258 - INFO -   Stack  - Acc: 0.615, Home MAE: 12.71, Away MAE: 8.14
2025-09-30 14:00:25,258 - INFO - 
Split 5/5: Train=234, Test=26
2025-09-30 14:00:31,682 - INFO -   Simple - Acc: 0.615, Home MAE: 11.20, Away MAE: 7.82
2025-09-30 14:00:31,682 - INFO -   Stack  - Acc: 0.615, Home MAE: 9.42, Away MAE: 6.81
2025-09-30 14:00:31,682 - INFO - 
================================================================================
2025-09-30 14:00:31,682 - INFO - COMPARISON RESULTS - United Rugby Championship
2025-09-30 14:00:31,682 - INFO - ================================================================================
2025-09-30 14:00:31,682 - INFO - Simple Model:
2025-09-30 14:00:31,682 - INFO -   Accuracy: 0.631 ± 0.031
2025-09-30 14:00:31,682 - INFO -   Overall MAE: 9.78
2025-09-30 14:00:31,682 - INFO - 
Stacking Model:
2025-09-30 14:00:31,682 - INFO -   Accuracy: 0.646 ± 0.057
2025-09-30 14:00:31,682 - INFO -   Overall MAE: 8.84
2025-09-30 14:00:31,683 - INFO - ================================================================================
2025-09-30 14:00:37,702 - INFO - 
================================================================================
2025-09-30 14:00:37,702 - INFO - Training optimized models for league 5069 (Currie Cup)
2025-09-30 14:00:37,702 - INFO - ================================================================================
2025-09-30 14:00:37,768 - INFO - Total games: 229
2025-09-30 14:00:37,768 - INFO - Total features before selection: 57
2025-09-30 14:00:37,770 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:00:38,513 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'away_rest_impact', 'elo_diff_squared', 'momentum_squared', 'home_strength_composite', 'rest_impact_diff', 'away_form', 'form_diff_squared', 'goal_diff_form_diff']
2025-09-30 14:00:38,513 - INFO - Features after selection: 50
2025-09-30 14:00:38,514 - INFO - Created 5 time-based splits
2025-09-30 14:00:38,514 - INFO - 
Split 1/5: Train=114, Test=23
2025-09-30 14:00:42,331 - INFO -   Simple - Acc: 0.478, Home MAE: 11.23, Away MAE: 13.99
2025-09-30 14:00:42,331 - INFO -   Stack  - Acc: 0.565, Home MAE: 10.51, Away MAE: 13.87
2025-09-30 14:00:42,331 - INFO - 
Split 2/5: Train=137, Test=23
2025-09-30 14:00:46,599 - INFO -   Simple - Acc: 0.609, Home MAE: 10.47, Away MAE: 8.42
2025-09-30 14:00:46,599 - INFO -   Stack  - Acc: 0.565, Home MAE: 8.13, Away MAE: 7.12
2025-09-30 14:00:46,599 - INFO - 
Split 3/5: Train=160, Test=23
2025-09-30 14:00:51,348 - INFO -   Simple - Acc: 0.609, Home MAE: 12.33, Away MAE: 8.06
2025-09-30 14:00:51,348 - INFO -   Stack  - Acc: 0.522, Home MAE: 10.00, Away MAE: 10.46
2025-09-30 14:00:51,348 - INFO - 
Split 4/5: Train=183, Test=23
2025-09-30 14:00:56,600 - INFO -   Simple - Acc: 0.435, Home MAE: 13.02, Away MAE: 14.63
2025-09-30 14:00:56,600 - INFO -   Stack  - Acc: 0.478, Home MAE: 10.49, Away MAE: 13.31
2025-09-30 14:00:56,600 - INFO - 
Split 5/5: Train=206, Test=23
2025-09-30 14:01:02,537 - INFO -   Simple - Acc: 0.652, Home MAE: 12.74, Away MAE: 13.10
2025-09-30 14:01:02,537 - INFO -   Stack  - Acc: 0.783, Home MAE: 14.71, Away MAE: 12.30
2025-09-30 14:01:02,538 - INFO - 
================================================================================
2025-09-30 14:01:02,538 - INFO - COMPARISON RESULTS - Currie Cup
2025-09-30 14:01:02,538 - INFO - ================================================================================
2025-09-30 14:01:02,538 - INFO - Simple Model:
2025-09-30 14:01:02,538 - INFO -   Accuracy: 0.557 ± 0.084
2025-09-30 14:01:02,538 - INFO -   Overall MAE: 11.80
2025-09-30 14:01:02,538 - INFO - 
Stacking Model:
2025-09-30 14:01:02,538 - INFO -   Accuracy: 0.583 ± 0.105
2025-09-30 14:01:02,538 - INFO -   Overall MAE: 11.09
2025-09-30 14:01:02,539 - INFO - ================================================================================
2025-09-30 14:01:08,063 - INFO - 
================================================================================
2025-09-30 14:01:08,063 - INFO - Training optimized models for league 4574 (Rugby World Cup)
2025-09-30 14:01:08,063 - INFO - ================================================================================
2025-09-30 14:01:08,128 - INFO - Total games: 151
2025-09-30 14:01:08,128 - INFO - Total features before selection: 57
2025-09-30 14:01:08,129 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:01:08,829 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'away_rest_days', 'elo_diff_squared', 'momentum_squared', 'elo_diff', 'form_diff', 'elo_away_pre', 'elo_home_pre', 'home_goal_diff_form']
2025-09-30 14:01:08,829 - INFO - Features after selection: 50
2025-09-30 14:01:08,830 - INFO - Created 5 time-based splits
2025-09-30 14:01:08,830 - INFO - 
Split 1/5: Train=75, Test=15
2025-09-30 14:01:08,936 - ERROR - Failed to train models for league 4574: y_true contains only one label (1). Please provide the true labels explicitly through the labels argument.
Traceback (most recent call last):
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 425, in main
    model_package = train_league_optimized(league_id, db_path)
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 270, in train_league_optimized
    clf_results = train_and_evaluate(X_train, y_clf_train, X_test, y_clf_test,
                                    model_type, 'classification')
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 181, in train_and_evaluate
    logloss = log_loss(y_test, y_proba)
  File "C:\Users\Dylan\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Dylan\AppData\Roaming\Python\Python313\site-packages\sklearn\metrics\_classification.py", line 2925, in log_loss
    raise ValueError(
    ...<3 lines>...
    )
ValueError: y_true contains only one label (1). Please provide the true labels explicitly through the labels argument.
2025-09-30 14:01:09,005 - INFO - Saved optimized model for league 4986 to artifacts_optimized\league_4986_model_optimized.pkl
2025-09-30 14:01:09,029 - INFO - Saved optimized model for league 4446 to artifacts_optimized\league_4446_model_optimized.pkl
2025-09-30 14:01:09,052 - INFO - Saved optimized model for league 5069 to artifacts_optimized\league_5069_model_optimized.pkl
2025-09-30 14:01:09,053 - INFO - Saved optimized model registry to artifacts_optimized\model_registry_optimized.json
2025-09-30 14:01:09,053 - INFO - 
================================================================================
2025-09-30 14:01:09,053 - INFO - Successfully trained optimized models for 3 leagues
2025-09-30 14:01:09,053 - INFO - ================================================================================
2025-09-30 14:01:09,053 - INFO - Rugby Championship: STACKING (Acc: 60.0%, MAE: 9.29)
2025-09-30 14:01:09,054 - INFO - United Rugby Championship: STACKING (Acc: 64.6%, MAE: 8.84)
2025-09-30 14:01:09,054 - INFO - Currie Cup: STACKING (Acc: 58.3%, MAE: 11.09)
2025-09-30 14:01:09,054 - INFO - 
Optimized model training completed successfully
2025-09-30 14:21:50,821 - INFO - ================================================================================
2025-09-30 14:21:50,821 - INFO - OPTIMIZED MODEL TRAINING
2025-09-30 14:21:50,822 - INFO - Improvements: Feature selection, Walk-forward validation, Model comparison
2025-09-30 14:21:50,822 - INFO - ================================================================================
2025-09-30 14:21:50,822 - INFO - 
================================================================================
2025-09-30 14:21:50,822 - INFO - Training optimized models for league 4986 (Rugby Championship)
2025-09-30 14:21:50,822 - INFO - ================================================================================
2025-09-30 14:21:50,887 - INFO - Total games: 140
2025-09-30 14:21:50,887 - INFO - Total features before selection: 57
2025-09-30 14:21:50,889 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:21:54,396 - INFO - Top 10 features: ['elo_momentum_interaction', 'elo_form_interaction', 'goal_diff_form_diff', 'elo_home_pre', 'form_momentum_interaction', 'away_wr_away', 'away_momentum_trend', 'away_form', 'away_form_10', 'home_goal_diff_form']
2025-09-30 14:21:54,396 - INFO - Features after selection: 50
2025-09-30 14:21:54,396 - INFO - Created 5 time-based splits
2025-09-30 14:21:54,396 - INFO - 
Split 1/5: Train=70, Test=14
2025-09-30 14:21:57,142 - INFO -   Simple - Acc: 0.500, Home MAE: 10.61, Away MAE: 7.85
2025-09-30 14:21:57,142 - INFO -   Stack  - Acc: 0.714, Home MAE: 9.86, Away MAE: 7.62
2025-09-30 14:21:57,142 - INFO - 
Split 2/5: Train=84, Test=14
2025-09-30 14:22:00,087 - INFO -   Simple - Acc: 0.500, Home MAE: 12.19, Away MAE: 10.04
2025-09-30 14:22:00,088 - INFO -   Stack  - Acc: 0.500, Home MAE: 11.17, Away MAE: 8.70
2025-09-30 14:22:00,088 - INFO - 
Split 3/5: Train=98, Test=14
2025-09-30 14:22:03,257 - INFO -   Simple - Acc: 0.429, Home MAE: 14.20, Away MAE: 10.61
2025-09-30 14:22:03,258 - INFO -   Stack  - Acc: 0.571, Home MAE: 10.44, Away MAE: 8.57
2025-09-30 14:22:03,258 - INFO - 
Split 4/5: Train=112, Test=14
2025-09-30 14:22:06,674 - INFO -   Simple - Acc: 0.643, Home MAE: 11.28, Away MAE: 10.57
2025-09-30 14:22:06,674 - INFO -   Stack  - Acc: 0.571, Home MAE: 11.08, Away MAE: 7.70
2025-09-30 14:22:06,674 - INFO - 
Split 5/5: Train=126, Test=14
2025-09-30 14:22:10,533 - INFO -   Simple - Acc: 0.643, Home MAE: 10.35, Away MAE: 9.76
2025-09-30 14:22:10,533 - INFO -   Stack  - Acc: 0.643, Home MAE: 9.48, Away MAE: 8.25
2025-09-30 14:22:10,533 - INFO - 
================================================================================
2025-09-30 14:22:10,533 - INFO - COMPARISON RESULTS - Rugby Championship
2025-09-30 14:22:10,533 - INFO - ================================================================================
2025-09-30 14:22:10,533 - INFO - Simple Model:
2025-09-30 14:22:10,533 - INFO -   Accuracy: 0.543 ± 0.086
2025-09-30 14:22:10,533 - INFO -   Overall MAE: 10.75
2025-09-30 14:22:10,533 - INFO - 
Stacking Model:
2025-09-30 14:22:10,533 - INFO -   Accuracy: 0.600 ± 0.073
2025-09-30 14:22:10,533 - INFO -   Overall MAE: 9.29
2025-09-30 14:22:10,536 - INFO - ================================================================================
2025-09-30 14:22:13,953 - INFO - 
================================================================================
2025-09-30 14:22:13,953 - INFO - Training optimized models for league 4446 (United Rugby Championship)
2025-09-30 14:22:13,953 - INFO - ================================================================================
2025-09-30 14:22:14,016 - INFO - Total games: 260
2025-09-30 14:22:14,016 - INFO - Total features before selection: 57
2025-09-30 14:22:14,018 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:22:14,757 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'strength_ratio_advanced', 'elo_diff_squared', 'home_goal_diff_form', 'elo_away_pre', 'momentum_diff', 'goal_diff_form_diff', 'elo_diff', 'rest_diff']
2025-09-30 14:22:14,758 - INFO - Features after selection: 50
2025-09-30 14:22:14,758 - INFO - Created 5 time-based splits
2025-09-30 14:22:14,758 - INFO - 
Split 1/5: Train=130, Test=26
2025-09-30 14:22:18,705 - INFO -   Simple - Acc: 0.654, Home MAE: 10.81, Away MAE: 7.47
2025-09-30 14:22:18,705 - INFO -   Stack  - Acc: 0.692, Home MAE: 8.71, Away MAE: 6.74
2025-09-30 14:22:18,705 - INFO - 
Split 2/5: Train=156, Test=26
2025-09-30 14:22:23,071 - INFO -   Simple - Acc: 0.577, Home MAE: 11.71, Away MAE: 9.19
2025-09-30 14:22:23,071 - INFO -   Stack  - Acc: 0.577, Home MAE: 11.87, Away MAE: 7.94
2025-09-30 14:22:23,071 - INFO - 
Split 3/5: Train=182, Test=26
2025-09-30 14:22:28,038 - INFO -   Simple - Acc: 0.654, Home MAE: 10.06, Away MAE: 6.71
2025-09-30 14:22:28,038 - INFO -   Stack  - Acc: 0.731, Home MAE: 9.03, Away MAE: 7.01
2025-09-30 14:22:28,038 - INFO - 
Split 4/5: Train=208, Test=26
2025-09-30 14:22:33,565 - INFO -   Simple - Acc: 0.654, Home MAE: 13.26, Away MAE: 9.53
2025-09-30 14:22:33,565 - INFO -   Stack  - Acc: 0.615, Home MAE: 12.71, Away MAE: 8.14
2025-09-30 14:22:33,565 - INFO - 
Split 5/5: Train=234, Test=26
2025-09-30 14:22:39,658 - INFO -   Simple - Acc: 0.615, Home MAE: 11.20, Away MAE: 7.82
2025-09-30 14:22:39,658 - INFO -   Stack  - Acc: 0.615, Home MAE: 9.42, Away MAE: 6.81
2025-09-30 14:22:39,658 - INFO - 
================================================================================
2025-09-30 14:22:39,659 - INFO - COMPARISON RESULTS - United Rugby Championship
2025-09-30 14:22:39,659 - INFO - ================================================================================
2025-09-30 14:22:39,659 - INFO - Simple Model:
2025-09-30 14:22:39,659 - INFO -   Accuracy: 0.631 ± 0.031
2025-09-30 14:22:39,659 - INFO -   Overall MAE: 9.78
2025-09-30 14:22:39,659 - INFO - 
Stacking Model:
2025-09-30 14:22:39,659 - INFO -   Accuracy: 0.646 ± 0.057
2025-09-30 14:22:39,659 - INFO -   Overall MAE: 8.84
2025-09-30 14:22:39,660 - INFO - ================================================================================
2025-09-30 14:22:45,360 - INFO - 
================================================================================
2025-09-30 14:22:45,360 - INFO - Training optimized models for league 5069 (Currie Cup)
2025-09-30 14:22:45,360 - INFO - ================================================================================
2025-09-30 14:22:45,423 - INFO - Total games: 229
2025-09-30 14:22:45,423 - INFO - Total features before selection: 57
2025-09-30 14:22:45,424 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:22:46,139 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'away_rest_impact', 'elo_diff_squared', 'momentum_squared', 'home_strength_composite', 'rest_impact_diff', 'away_form', 'form_diff_squared', 'goal_diff_form_diff']
2025-09-30 14:22:46,140 - INFO - Features after selection: 50
2025-09-30 14:22:46,140 - INFO - Created 5 time-based splits
2025-09-30 14:22:46,140 - INFO - 
Split 1/5: Train=114, Test=23
2025-09-30 14:22:49,771 - INFO -   Simple - Acc: 0.478, Home MAE: 11.23, Away MAE: 13.99
2025-09-30 14:22:49,771 - INFO -   Stack  - Acc: 0.565, Home MAE: 10.51, Away MAE: 13.87
2025-09-30 14:22:49,771 - INFO - 
Split 2/5: Train=137, Test=23
2025-09-30 14:22:53,870 - INFO -   Simple - Acc: 0.609, Home MAE: 10.47, Away MAE: 8.42
2025-09-30 14:22:53,870 - INFO -   Stack  - Acc: 0.565, Home MAE: 8.13, Away MAE: 7.12
2025-09-30 14:22:53,870 - INFO - 
Split 3/5: Train=160, Test=23
2025-09-30 14:22:58,474 - INFO -   Simple - Acc: 0.609, Home MAE: 12.33, Away MAE: 8.06
2025-09-30 14:22:58,475 - INFO -   Stack  - Acc: 0.522, Home MAE: 10.00, Away MAE: 10.46
2025-09-30 14:22:58,475 - INFO - 
Split 4/5: Train=183, Test=23
2025-09-30 14:23:03,516 - INFO -   Simple - Acc: 0.435, Home MAE: 13.02, Away MAE: 14.63
2025-09-30 14:23:03,516 - INFO -   Stack  - Acc: 0.478, Home MAE: 10.49, Away MAE: 13.31
2025-09-30 14:23:03,516 - INFO - 
Split 5/5: Train=206, Test=23
2025-09-30 14:23:09,093 - INFO -   Simple - Acc: 0.652, Home MAE: 12.74, Away MAE: 13.10
2025-09-30 14:23:09,093 - INFO -   Stack  - Acc: 0.783, Home MAE: 14.71, Away MAE: 12.30
2025-09-30 14:23:09,093 - INFO - 
================================================================================
2025-09-30 14:23:09,094 - INFO - COMPARISON RESULTS - Currie Cup
2025-09-30 14:23:09,094 - INFO - ================================================================================
2025-09-30 14:23:09,094 - INFO - Simple Model:
2025-09-30 14:23:09,094 - INFO -   Accuracy: 0.557 ± 0.084
2025-09-30 14:23:09,094 - INFO -   Overall MAE: 11.80
2025-09-30 14:23:09,094 - INFO - 
Stacking Model:
2025-09-30 14:23:09,094 - INFO -   Accuracy: 0.583 ± 0.105
2025-09-30 14:23:09,094 - INFO -   Overall MAE: 11.09
2025-09-30 14:23:09,095 - INFO - ================================================================================
2025-09-30 14:23:14,405 - INFO - 
================================================================================
2025-09-30 14:23:14,405 - INFO - Training optimized models for league 4574 (Rugby World Cup)
2025-09-30 14:23:14,405 - INFO - ================================================================================
2025-09-30 14:23:14,470 - INFO - Total games: 151
2025-09-30 14:23:14,470 - INFO - Total features before selection: 57
2025-09-30 14:23:14,471 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:23:15,157 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'away_rest_days', 'elo_diff_squared', 'momentum_squared', 'elo_diff', 'form_diff', 'elo_away_pre', 'elo_home_pre', 'home_goal_diff_form']
2025-09-30 14:23:15,158 - INFO - Features after selection: 50
2025-09-30 14:23:15,158 - INFO - Created 5 time-based splits
2025-09-30 14:23:15,158 - INFO - 
Split 1/5: Train=75, Test=15
2025-09-30 14:23:15,261 - ERROR - Failed to train models for league 4574: y_true contains only one label (1). Please provide the true labels explicitly through the labels argument.
Traceback (most recent call last):
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 425, in main
    model_package = train_league_optimized(league_id, db_path)
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 270, in train_league_optimized
    clf_results = train_and_evaluate(X_train, y_clf_train, X_test, y_clf_test,
                                    model_type, 'classification')
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 181, in train_and_evaluate
    logloss = log_loss(y_test, y_proba)
  File "C:\Users\Dylan\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Dylan\AppData\Roaming\Python\Python313\site-packages\sklearn\metrics\_classification.py", line 2925, in log_loss
    raise ValueError(
    ...<3 lines>...
    )
ValueError: y_true contains only one label (1). Please provide the true labels explicitly through the labels argument.
2025-09-30 14:23:15,333 - INFO - Saved optimized model for league 4986 to artifacts_optimized\league_4986_model_optimized.pkl
2025-09-30 14:23:15,361 - INFO - Saved optimized model for league 4446 to artifacts_optimized\league_4446_model_optimized.pkl
2025-09-30 14:23:15,382 - INFO - Saved optimized model for league 5069 to artifacts_optimized\league_5069_model_optimized.pkl
2025-09-30 14:23:15,383 - INFO - Saved optimized model registry to artifacts_optimized\model_registry_optimized.json
2025-09-30 14:23:15,383 - INFO - 
================================================================================
2025-09-30 14:23:15,383 - INFO - Successfully trained optimized models for 3 leagues
2025-09-30 14:23:15,383 - INFO - ================================================================================
2025-09-30 14:23:15,383 - INFO - Rugby Championship: STACKING (Acc: 60.0%, MAE: 9.29)
2025-09-30 14:23:15,384 - INFO - United Rugby Championship: STACKING (Acc: 64.6%, MAE: 8.84)
2025-09-30 14:23:15,384 - INFO - Currie Cup: STACKING (Acc: 58.3%, MAE: 11.09)
2025-09-30 14:23:15,384 - INFO - 
Optimized model training completed successfully
2025-09-30 14:23:47,933 - INFO - ================================================================================
2025-09-30 14:23:47,934 - INFO - OPTIMIZED MODEL TRAINING
2025-09-30 14:23:47,934 - INFO - Improvements: Feature selection, Walk-forward validation, Model comparison
2025-09-30 14:23:47,934 - INFO - ================================================================================
2025-09-30 14:23:47,934 - INFO - 
================================================================================
2025-09-30 14:23:47,934 - INFO - Training optimized models for league 4986 (Rugby Championship)
2025-09-30 14:23:47,934 - INFO - ================================================================================
2025-09-30 14:23:48,007 - INFO - Total games: 140
2025-09-30 14:23:48,007 - INFO - Total features before selection: 57
2025-09-30 14:23:48,009 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:23:51,712 - INFO - Top 10 features: ['elo_momentum_interaction', 'elo_form_interaction', 'goal_diff_form_diff', 'elo_home_pre', 'form_momentum_interaction', 'away_wr_away', 'away_momentum_trend', 'away_form', 'away_form_10', 'home_goal_diff_form']
2025-09-30 14:23:51,712 - INFO - Features after selection: 50
2025-09-30 14:23:51,712 - INFO - Created 5 time-based splits
2025-09-30 14:23:51,712 - INFO - 
Split 1/5: Train=70, Test=14
2025-09-30 14:23:54,473 - INFO -   Simple - Acc: 0.500, Home MAE: 10.61, Away MAE: 7.85
2025-09-30 14:23:54,473 - INFO -   Stack  - Acc: 0.714, Home MAE: 9.86, Away MAE: 7.62
2025-09-30 14:23:54,473 - INFO - 
Split 2/5: Train=84, Test=14
2025-09-30 14:23:57,631 - INFO -   Simple - Acc: 0.500, Home MAE: 12.19, Away MAE: 10.04
2025-09-30 14:23:57,631 - INFO -   Stack  - Acc: 0.500, Home MAE: 11.17, Away MAE: 8.70
2025-09-30 14:23:57,631 - INFO - 
Split 3/5: Train=98, Test=14
2025-09-30 14:24:00,902 - INFO -   Simple - Acc: 0.429, Home MAE: 14.20, Away MAE: 10.61
2025-09-30 14:24:00,902 - INFO -   Stack  - Acc: 0.571, Home MAE: 10.44, Away MAE: 8.57
2025-09-30 14:24:00,902 - INFO - 
Split 4/5: Train=112, Test=14
2025-09-30 14:24:04,451 - INFO -   Simple - Acc: 0.643, Home MAE: 11.28, Away MAE: 10.57
2025-09-30 14:24:04,451 - INFO -   Stack  - Acc: 0.571, Home MAE: 11.08, Away MAE: 7.70
2025-09-30 14:24:04,451 - INFO - 
Split 5/5: Train=126, Test=14
2025-09-30 14:24:08,263 - INFO -   Simple - Acc: 0.643, Home MAE: 10.35, Away MAE: 9.76
2025-09-30 14:24:08,263 - INFO -   Stack  - Acc: 0.643, Home MAE: 9.48, Away MAE: 8.25
2025-09-30 14:24:08,264 - INFO - 
================================================================================
2025-09-30 14:24:08,264 - INFO - COMPARISON RESULTS - Rugby Championship
2025-09-30 14:24:08,264 - INFO - ================================================================================
2025-09-30 14:24:08,264 - INFO - Simple Model:
2025-09-30 14:24:08,264 - INFO -   Accuracy: 0.543 ± 0.086
2025-09-30 14:24:08,264 - INFO -   Overall MAE: 10.75
2025-09-30 14:24:08,264 - INFO - 
Stacking Model:
2025-09-30 14:24:08,264 - INFO -   Accuracy: 0.600 ± 0.073
2025-09-30 14:24:08,264 - INFO -   Overall MAE: 9.29
2025-09-30 14:24:08,266 - INFO - ================================================================================
2025-09-30 14:24:11,794 - INFO - 
================================================================================
2025-09-30 14:24:11,794 - INFO - Training optimized models for league 4446 (United Rugby Championship)
2025-09-30 14:24:11,794 - INFO - ================================================================================
2025-09-30 14:24:11,864 - INFO - Total games: 260
2025-09-30 14:24:11,865 - INFO - Total features before selection: 57
2025-09-30 14:24:11,866 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:24:12,613 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'elo_diff_squared', 'home_goal_diff_form', 'elo_away_pre', 'strength_ratio_advanced', 'momentum_diff', 'home_strength_composite', 'elo_form_interaction', 'elo_sum']
2025-09-30 14:24:12,613 - INFO - Features after selection: 50
2025-09-30 14:24:12,613 - INFO - Created 5 time-based splits
2025-09-30 14:24:12,614 - INFO - 
Split 1/5: Train=130, Test=26
2025-09-30 14:24:16,647 - INFO -   Simple - Acc: 0.615, Home MAE: 10.75, Away MAE: 7.43
2025-09-30 14:24:16,647 - INFO -   Stack  - Acc: 0.692, Home MAE: 8.62, Away MAE: 6.80
2025-09-30 14:24:16,647 - INFO - 
Split 2/5: Train=156, Test=26
2025-09-30 14:24:21,105 - INFO -   Simple - Acc: 0.615, Home MAE: 11.63, Away MAE: 9.26
2025-09-30 14:24:21,105 - INFO -   Stack  - Acc: 0.577, Home MAE: 11.96, Away MAE: 7.92
2025-09-30 14:24:21,105 - INFO - 
Split 3/5: Train=182, Test=26
2025-09-30 14:24:26,190 - INFO -   Simple - Acc: 0.654, Home MAE: 8.97, Away MAE: 6.71
2025-09-30 14:24:26,190 - INFO -   Stack  - Acc: 0.731, Home MAE: 9.04, Away MAE: 7.03
2025-09-30 14:24:26,190 - INFO - 
Split 4/5: Train=208, Test=26
2025-09-30 14:24:31,679 - INFO -   Simple - Acc: 0.615, Home MAE: 12.53, Away MAE: 9.22
2025-09-30 14:24:31,679 - INFO -   Stack  - Acc: 0.615, Home MAE: 12.52, Away MAE: 8.14
2025-09-30 14:24:31,679 - INFO - 
Split 5/5: Train=234, Test=26
2025-09-30 14:24:37,724 - INFO -   Simple - Acc: 0.538, Home MAE: 10.95, Away MAE: 7.40
2025-09-30 14:24:37,724 - INFO -   Stack  - Acc: 0.654, Home MAE: 9.36, Away MAE: 6.82
2025-09-30 14:24:37,724 - INFO - 
================================================================================
2025-09-30 14:24:37,724 - INFO - COMPARISON RESULTS - United Rugby Championship
2025-09-30 14:24:37,724 - INFO - ================================================================================
2025-09-30 14:24:37,724 - INFO - Simple Model:
2025-09-30 14:24:37,724 - INFO -   Accuracy: 0.608 ± 0.038
2025-09-30 14:24:37,724 - INFO -   Overall MAE: 9.48
2025-09-30 14:24:37,725 - INFO - 
Stacking Model:
2025-09-30 14:24:37,725 - INFO -   Accuracy: 0.654 ± 0.054
2025-09-30 14:24:37,725 - INFO -   Overall MAE: 8.82
2025-09-30 14:24:37,725 - INFO - ================================================================================
2025-09-30 14:24:43,592 - INFO - 
================================================================================
2025-09-30 14:24:43,592 - INFO - Training optimized models for league 5069 (Currie Cup)
2025-09-30 14:24:43,592 - INFO - ================================================================================
2025-09-30 14:24:43,662 - INFO - Total games: 229
2025-09-30 14:24:43,662 - INFO - Total features before selection: 57
2025-09-30 14:24:43,664 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:24:44,385 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'away_rest_impact', 'momentum_squared', 'rest_impact_diff', 'home_strength_composite', 'away_form', 'elo_diff_squared', 'goal_diff_form_diff', 'elo_momentum_interaction']
2025-09-30 14:24:44,385 - INFO - Features after selection: 50
2025-09-30 14:24:44,386 - INFO - Created 5 time-based splits
2025-09-30 14:24:44,386 - INFO - 
Split 1/5: Train=114, Test=23
2025-09-30 14:24:48,047 - INFO -   Simple - Acc: 0.522, Home MAE: 10.93, Away MAE: 13.74
2025-09-30 14:24:48,048 - INFO -   Stack  - Acc: 0.565, Home MAE: 10.45, Away MAE: 13.72
2025-09-30 14:24:48,048 - INFO - 
Split 2/5: Train=137, Test=23
2025-09-30 14:24:52,179 - INFO -   Simple - Acc: 0.609, Home MAE: 10.39, Away MAE: 7.29
2025-09-30 14:24:52,179 - INFO -   Stack  - Acc: 0.565, Home MAE: 8.30, Away MAE: 7.28
2025-09-30 14:24:52,179 - INFO - 
Split 3/5: Train=160, Test=23
2025-09-30 14:24:56,747 - INFO -   Simple - Acc: 0.609, Home MAE: 12.09, Away MAE: 7.96
2025-09-30 14:24:56,747 - INFO -   Stack  - Acc: 0.522, Home MAE: 9.90, Away MAE: 10.47
2025-09-30 14:24:56,747 - INFO - 
Split 4/5: Train=183, Test=23
2025-09-30 14:25:01,759 - INFO -   Simple - Acc: 0.478, Home MAE: 13.29, Away MAE: 14.23
2025-09-30 14:25:01,759 - INFO -   Stack  - Acc: 0.435, Home MAE: 10.61, Away MAE: 13.17
2025-09-30 14:25:01,759 - INFO - 
Split 5/5: Train=206, Test=23
2025-09-30 14:25:07,368 - INFO -   Simple - Acc: 0.696, Home MAE: 13.49, Away MAE: 12.98
2025-09-30 14:25:07,368 - INFO -   Stack  - Acc: 0.826, Home MAE: 14.76, Away MAE: 12.42
2025-09-30 14:25:07,369 - INFO - 
================================================================================
2025-09-30 14:25:07,369 - INFO - COMPARISON RESULTS - Currie Cup
2025-09-30 14:25:07,369 - INFO - ================================================================================
2025-09-30 14:25:07,369 - INFO - Simple Model:
2025-09-30 14:25:07,369 - INFO -   Accuracy: 0.583 ± 0.076
2025-09-30 14:25:07,369 - INFO -   Overall MAE: 11.64
2025-09-30 14:25:07,369 - INFO - 
Stacking Model:
2025-09-30 14:25:07,369 - INFO -   Accuracy: 0.583 ± 0.131
2025-09-30 14:25:07,369 - INFO -   Overall MAE: 11.11
2025-09-30 14:25:07,370 - INFO - ================================================================================
2025-09-30 14:25:12,643 - INFO - 
================================================================================
2025-09-30 14:25:12,643 - INFO - Training optimized models for league 4574 (Rugby World Cup)
2025-09-30 14:25:12,643 - INFO - ================================================================================
2025-09-30 14:25:12,754 - INFO - Total games: 151
2025-09-30 14:25:12,754 - INFO - Total features before selection: 57
2025-09-30 14:25:12,756 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:25:13,440 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'away_rest_days', 'elo_diff_squared', 'momentum_squared', 'elo_diff', 'form_diff', 'elo_away_pre', 'elo_home_pre', 'home_goal_diff_form']
2025-09-30 14:25:13,440 - INFO - Features after selection: 50
2025-09-30 14:25:13,440 - INFO - Created 5 time-based splits
2025-09-30 14:25:13,440 - INFO - 
Split 1/5: Train=75, Test=15
2025-09-30 14:25:13,539 - ERROR - Failed to train models for league 4574: y_true contains only one label (1). Please provide the true labels explicitly through the labels argument.
Traceback (most recent call last):
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 428, in main
    model_package = train_league_optimized(league_id, db_path)
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 273, in train_league_optimized
    clf_results = train_and_evaluate(X_train, y_clf_train, X_test, y_clf_test,
                                    model_type, 'classification')
  File "C:\Users\Dylan\Desktop\Prediction\scripts\train_models_optimized.py", line 184, in train_and_evaluate
    logloss = log_loss(y_test, y_proba)
  File "C:\Users\Dylan\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Dylan\AppData\Roaming\Python\Python313\site-packages\sklearn\metrics\_classification.py", line 2925, in log_loss
    raise ValueError(
    ...<3 lines>...
    )
ValueError: y_true contains only one label (1). Please provide the true labels explicitly through the labels argument.
2025-09-30 14:25:13,541 - INFO - 
================================================================================
2025-09-30 14:25:13,542 - INFO - Training optimized models for league 4551 (Super Rugby)
2025-09-30 14:25:13,542 - INFO - ================================================================================
2025-09-30 14:25:13,617 - INFO - Total games: 104
2025-09-30 14:25:13,617 - INFO - Total features before selection: 57
2025-09-30 14:25:13,619 - INFO - Selecting top 50 features from 57 total
2025-09-30 14:25:14,300 - INFO - Top 10 features: ['home_wr_home', 'away_wr_away', 'elo_diff_squared', 'form_diff_squared', 'elo_sum', 'strength_ratio_advanced', 'home_goal_diff_form', 'form_diff_10_advanced', 'form_momentum_interaction', 'away_goal_diff_form']
2025-09-30 14:25:14,301 - INFO - Features after selection: 50
2025-09-30 14:25:14,301 - INFO - Created 5 time-based splits
2025-09-30 14:25:14,301 - INFO - 
Split 1/5: Train=52, Test=10
2025-09-30 14:25:16,724 - INFO -   Simple - Acc: 0.700, Home MAE: 10.30, Away MAE: 12.28
2025-09-30 14:25:16,724 - INFO -   Stack  - Acc: 0.800, Home MAE: 12.10, Away MAE: 15.87
2025-09-30 14:25:16,724 - INFO - 
Split 2/5: Train=62, Test=10
2025-09-30 14:25:19,399 - INFO -   Simple - Acc: 0.700, Home MAE: 10.35, Away MAE: 9.38
2025-09-30 14:25:19,399 - INFO -   Stack  - Acc: 0.600, Home MAE: 8.00, Away MAE: 9.59
2025-09-30 14:25:19,399 - INFO - 
Split 3/5: Train=72, Test=10
2025-09-30 14:25:22,286 - INFO -   Simple - Acc: 0.700, Home MAE: 8.95, Away MAE: 10.48
2025-09-30 14:25:22,286 - INFO -   Stack  - Acc: 0.500, Home MAE: 14.42, Away MAE: 9.58
2025-09-30 14:25:22,286 - INFO - 
Split 4/5: Train=82, Test=10
2025-09-30 14:25:25,317 - INFO -   Simple - Acc: 0.700, Home MAE: 11.59, Away MAE: 8.80
2025-09-30 14:25:25,317 - INFO -   Stack  - Acc: 0.800, Home MAE: 9.89, Away MAE: 10.04
2025-09-30 14:25:25,317 - INFO - 
Split 5/5: Train=92, Test=10
2025-09-30 14:25:28,573 - INFO -   Simple - Acc: 0.600, Home MAE: 12.26, Away MAE: 11.80
2025-09-30 14:25:28,573 - INFO -   Stack  - Acc: 0.800, Home MAE: 11.57, Away MAE: 9.83
2025-09-30 14:25:28,573 - INFO - 
================================================================================
2025-09-30 14:25:28,573 - INFO - COMPARISON RESULTS - Super Rugby
2025-09-30 14:25:28,574 - INFO - ================================================================================
2025-09-30 14:25:28,574 - INFO - Simple Model:
2025-09-30 14:25:28,574 - INFO -   Accuracy: 0.680 ± 0.040
2025-09-30 14:25:28,574 - INFO -   Overall MAE: 10.62
2025-09-30 14:25:28,574 - INFO - 
Stacking Model:
2025-09-30 14:25:28,574 - INFO -   Accuracy: 0.700 ± 0.126
2025-09-30 14:25:28,574 - INFO -   Overall MAE: 11.09
2025-09-30 14:25:28,575 - INFO - ================================================================================
2025-09-30 14:25:31,579 - INFO - 
================================================================================
2025-09-30 14:25:31,579 - INFO - Training optimized models for league 4430 (French Top 14)
2025-09-30 14:25:31,579 - INFO - ================================================================================
2025-09-30 14:25:31,649 - WARNING - Insufficient data for league 4430: 0 games
2025-09-30 14:25:31,649 - INFO - 
================================================================================
2025-09-30 14:25:31,649 - INFO - Training optimized models for league 4414 (English Premiership Rugby)
2025-09-30 14:25:31,649 - INFO - ================================================================================
2025-09-30 14:25:31,719 - WARNING - Insufficient data for league 4414: 0 games
2025-09-30 14:25:31,736 - INFO - Saved optimized model for league 4986 to artifacts_optimized\league_4986_model_optimized.pkl
2025-09-30 14:25:31,755 - INFO - Saved optimized model for league 4446 to artifacts_optimized\league_4446_model_optimized.pkl
2025-09-30 14:25:31,774 - INFO - Saved optimized model for league 5069 to artifacts_optimized\league_5069_model_optimized.pkl
2025-09-30 14:25:31,791 - INFO - Saved optimized model for league 4551 to artifacts_optimized\league_4551_model_optimized.pkl
2025-09-30 14:25:31,793 - INFO - Saved optimized model registry to artifacts_optimized\model_registry_optimized.json
2025-09-30 14:25:31,793 - INFO - 
================================================================================
2025-09-30 14:25:31,793 - INFO - Successfully trained optimized models for 4 leagues
2025-09-30 14:25:31,793 - INFO - ================================================================================
2025-09-30 14:25:31,793 - INFO - Rugby Championship: STACKING (Acc: 60.0%, MAE: 9.29)
2025-09-30 14:25:31,793 - INFO - United Rugby Championship: STACKING (Acc: 65.4%, MAE: 8.82)
2025-09-30 14:25:31,793 - INFO - Currie Cup: STACKING (Acc: 58.3%, MAE: 11.11)
2025-09-30 14:25:31,793 - INFO - Super Rugby: STACKING (Acc: 70.0%, MAE: 11.09)
2025-09-30 14:25:31,793 - INFO - 
Optimized model training completed successfully
